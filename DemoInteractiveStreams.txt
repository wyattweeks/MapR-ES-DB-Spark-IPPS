##Run the java publisher and the Spark consumer**
#This client will read lines from the file in ~/MapR-ES-DB-Spark-Payments/data/payments.csv and publish them to the topic /streams/paystream:payments. 
#You can optionally pass the file and topic as input parameters <file topic> 
java -cp ~/MapR-ES-DB-Spark-Payments/target/mapr-es-db-spark-payment-1.0.jar:./target/* streams.MsgProducer

###This spark streaming client will consume from the topic /streams/paystream:payments and write to the table /tables/payments.
# You can wait for the java client to finish, or from a separate terminal you can run the spark streaming consumer with the following command
#You can optionally pass the topic and table as input parameters <topic table> 

# use chads code to detect spark bin to point to spark submit script loc
#SPARK_VERSION=`apt-cache policy mapr-spark | grep Installed | awk '{print$2}' | cut -c 1-5`
#SPARK_PATH="/opt/mapr/opentsdb/opentsdb-$SPARK_VERSION"
#SPARK_VERSION=`apt-cache policy mapr-spark | grep Installed | awk '{print$2}' | cut -c 1-5`
#SPARK_PATH="/opt/mapr/spark/spark-$SPARK_VERSION"
#./$SPARK_PATH/bin/spark-submit
#./spark-submit --class streaming.SparkKafkaConsumer --master local[2] ~/MapR-ES-DB-Spark-Payments/target/mapr-es-db-spark-payment-1.0.jar
cd /opt/mapr/spark/spark-2.2.1/bin
./spark-submit --class streaming.SparkKafkaConsumer --master local[2] ~/MapR-ES-DB-Spark-Payments/target/mapr-es-db-spark-payment-1.0.jar


#### 3. Run the Spark SQL client to load and query data from MapR-DB with Spark-DB Connector

#You can wait for the java client and spark consumer to finish, or from a separate mac terminal you can run the spark sql with the following command, 
#or you can run from your IDE :
cd /opt/mapr/spark/spark-2.2.1/bin
./spark-submit --class sparkmaprdb.QueryPayment --master local[2] ~/MapR-ES-DB-Spark-Payments/target/mapr-es-db-spark-payment-1.0.jar

# this part is an OPTION to the step above
# in a sparate terminal window, start the spark shell with this command
# add paramenter to spark version
# need to automate the 'copy paste step below'
#$ /opt/mapr/spark/spark-2.2.1/bin/spark-shell --master local[2]
#copy paste  from the scripts/sparkshell file to query MapR-DB